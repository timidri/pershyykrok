---
import HomePageContent from '../../components/HomePageContent.astro';
import { fetchHomePageData } from '../../lib/content';
import { assertLocaleOrRedirect } from '../../lib/locale';
import BaseLayout from '../../layouts/BaseLayout.astro';

export function getStaticPaths() {
  return [{ params: { locale: 'ua' } }, { params: { locale: 'ru' } }];
}

const { locale } = Astro.params as { locale: string };
const localeValue = assertLocaleOrRedirect(locale, Astro.redirect);

const { data, siteSettings } = await fetchHomePageData({ locale: localeValue });

if (!data) return Astro.redirect('/404');

const contact = siteSettings?.contact ?? null;
---

<BaseLayout title={data.title ?? 'Home'} locale={localeValue} currentPath={`/${localeValue}`}>
  <HomePageContent data={data} contact={contact} locale={localeValue} />
</BaseLayout>
