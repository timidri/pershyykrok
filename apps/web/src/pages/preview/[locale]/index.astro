---
import BaseLayout from '../../../layouts/BaseLayout.astro';
import HomePageContent from '../../../components/HomePageContent.astro';
import { fetchHomePageData } from '../../../lib/content';
import { assertLocaleOrRedirect } from '../../../lib/locale';
import { requirePreview } from '../../../lib/preview';

export const prerender = false;

const { locale } = Astro.params as { locale: string };
const localeValue = assertLocaleOrRedirect(locale, Astro.redirect);
requirePreview(Astro);

const { data, siteSettings } = await fetchHomePageData({ locale: localeValue, preview: true });

if (!data) return Astro.redirect('/404');

const contact = siteSettings?.contact ?? null;
---

<BaseLayout
  title={data.title ?? 'Home'}
  locale={localeValue}
  currentPath={`/${localeValue}`}
  isPreview={true}
>
  <HomePageContent data={data} contact={contact} locale={localeValue} />
</BaseLayout>
